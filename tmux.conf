# Change prefix from Ctrl+B to Ctrl+A
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Eliminate escape delay (critical for vim)
set -sg escape-time 0

# Enable mouse support
set -g mouse on

# Forward focus changes to terminal apps (needed for nvim FocusGained autocmds)
set -g focus-events on

# Allow terminal to handle clicks on links (OSC 8 hyperlinks)
set -g allow-passthrough on

# Use vim keys in copy mode
setw -g mode-keys vi

# Vim-style pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Intuitive splits: | for vertical, _ for horizontal
bind | split-window -h
bind _ split-window -v

# Vim-style pane resizing (repeatable)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Session navigation
bind \\ switch-client -l       # Toggle last session
bind -r ( switch-client -p     # Previous session
bind -r ) switch-client -n     # Next session (cycle)

# Vim-style copy mode: v to select, y to yank
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "xclip -selection clipboard"

# Copy to clipboard on mouse drag release
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -selection clipboard"

# Disable auto-rename so your names stick
set-option -g allow-rename off
set-option -g automatic-rename off

# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'catppuccin/tmux'

# Catppuccin theme settings (set BEFORE loading plugin)
set -g @catppuccin_flavor 'mocha'
set -g @catppuccin_window_status_style 'rounded'
set -g @catppuccin_window_text '#W'
set -g @catppuccin_window_current_text '#W'

# Resurrect settings
set -g @resurrect-processes 'nvim vim'
set -g @resurrect-strategy-nvim 'session'

# Continuum settings (auto-save every 15 min, auto-restore on tmux start)
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# Initialize TPM
run '~/.tmux/plugins/tpm/tpm'

# Status bar setup (AFTER plugin loads)
set -g status-right-length 200
set -g status-left-length 100
set -g status-left "#{E:@catppuccin_status_session}"
set -g status-right "#{E:@catppuccin_status_directory}"
set -ag status-right "#{E:@catppuccin_status_gitmux}"
set -ag status-right "#{E:@catppuccin_status_application}"
set -ag status-right "#{E:@catppuccin_status_date_time}"
